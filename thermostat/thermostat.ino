 /***************************************************
  Arduino Thermostat
 ****************************************************/

#include <Adafruit_GFX.h>    // Core graphics library
#include <SPI.h>       // this is needed for display
#include <Adafruit_ILI9341.h>
#include <Wire.h>      // this is needed for FT6206
#include <Adafruit_FT6206.h>

uint16_t backgroundColor = ILI9341_WHITE;
String modeString = "null";

// home button bitmap 
const unsigned char homeButton [] PROGMEM = {
  // 'dynnamitt_home, 30x30px
  0x00, 0x03, 0x00, 0x00, 0x00, 0x07, 0x80, 0x00, 0x07, 0x0f, 0xc0, 0x00, 0x0f, 0x1f, 0xe0, 0x00, 
  0x0f, 0x3c, 0xf0, 0x00, 0x0e, 0x78, 0x78, 0x00, 0x0c, 0xf3, 0x1c, 0x00, 0x01, 0xe7, 0x8e, 0x00, 
  0x03, 0x8f, 0xc7, 0x00, 0x07, 0x1f, 0xe3, 0x80, 0x0e, 0x3f, 0xf1, 0xc0, 0x1c, 0xff, 0xfc, 0xe0, 
  0x39, 0xff, 0xfe, 0x70, 0x73, 0xff, 0xff, 0x38, 0xe7, 0xff, 0xff, 0x9c, 0x47, 0xff, 0xff, 0xc8, 
  0x0f, 0xff, 0xff, 0xc0, 0x0f, 0xff, 0xff, 0xc0, 0x0f, 0xff, 0xff, 0xc0, 0x0f, 0xff, 0xff, 0xc0, 
  0x0f, 0xff, 0xff, 0xc0, 0x0f, 0xff, 0xff, 0xc0, 0x0f, 0xff, 0xff, 0xc0, 0x0f, 0xf0, 0x3f, 0xc0, 
  0x0f, 0xf0, 0x3f, 0xc0, 0x0f, 0xf0, 0x3f, 0xc0, 0x0f, 0xf0, 0x3f, 0xc0, 0x0f, 0xf0, 0x3f, 0xc0, 
  0x0f, 0xf0, 0x3f, 0xc0, 0x07, 0xf0, 0x3f, 0x80
};


// settings button
const unsigned char settingsButton [] PROGMEM = {
  // 'Settings_black-512, 30x30px
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x18, 0x60, 0x00, 0x00, 0x78, 0x78, 0x00, 
  0x00, 0xfc, 0xfc, 0x00, 0x00, 0xff, 0xfc, 0x00, 0x00, 0xff, 0xfc, 0x00, 0x00, 0xff, 0xfc, 0x00, 
  0x0f, 0xff, 0xff, 0xc0, 0x1f, 0xfc, 0xff, 0xe0, 0x1f, 0xf0, 0x3f, 0xe0, 0x3f, 0xe0, 0x1f, 0xf0, 
  0x3f, 0xc0, 0x0f, 0xf0, 0x0f, 0xc0, 0x07, 0xe0, 0x07, 0x80, 0x07, 0x80, 0x07, 0x80, 0x07, 0x80, 
  0x0f, 0xc0, 0x07, 0xc0, 0x3f, 0xc0, 0x0f, 0xf0, 0x3f, 0xe0, 0x0f, 0xf0, 0x1f, 0xf0, 0x1f, 0xe0, 
  0x1f, 0xf8, 0x7f, 0xe0, 0x0f, 0xff, 0xff, 0xc0, 0x00, 0xff, 0xfe, 0x00, 0x00, 0xff, 0xfc, 0x00, 
  0x00, 0xff, 0xfc, 0x00, 0x00, 0xfc, 0xfc, 0x00, 0x00, 0x7c, 0x78, 0x00, 0x00, 0x18, 0x60, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
};

// The FT6206 uses hardware I2C (SCL/SDA)
Adafruit_FT6206 ctp = Adafruit_FT6206();

// The display also uses hardware SPI, plus #9 & #10
#define TFT_CS 10
#define TFT_DC 9
Adafruit_ILI9341 tft = Adafruit_ILI9341(TFT_CS, TFT_DC);


void setup(void) {
  while (!Serial);     // used for leonardo debugging
 
  Serial.begin(115200);
  
  tft.begin();

  if (! ctp.begin(40)) {  // pass in 'sensitivity' coefficient
    Serial.println("Couldn't start FT6206 touchscreen controller");
    while (1);
  }

//if cooling
backgroundColor = ILI9341_BLUE;
modeString = "Cooling";

tft.setRotation(3);
homepage();
  
}

void homepage(){
  
  tft.fillScreen(backgroundColor);
  tft.drawBitmap(280, 10, homeButton, 30, 30, ILI9341_BLACK); // pixel location of homepage: 280-310 x, 10-40 y
  tft.drawBitmap(280, 75, settingsButton, 30, 30, ILI9341_BLACK); // pixel location of homepage: 280-310 x, 75-105 y

  tft.setTextSize(7);
  tft.setTextColor(0x0000);

  tft.setCursor(40,40);
  tft.print("79");
  tft.print((char)247);

  tft.setCursor(40,150);
  tft.setTextSize(3);
  tft.print(modeString);
  }

void settingsPage(){
  
  tft.fillScreen(backgroundColor);
  tft.drawBitmap(280, 10, homeButton, 30, 30, ILI9341_BLACK); // pixel location of homepage: 280-310 x, 10-40 y
  tft.drawBitmap(280, 75, settingsButton, 30, 30, ILI9341_BLACK); // pixel location of homepage: 280-310 x, 75-105 y
  
  tft.setTextSize(3);
  tft.setTextColor(0x0000);

  tft.setCursor(40,40);
  tft.print("Settings");
 
  }

  
void loop() {
  // Wait for a touch
  if (! ctp.touched()) {
    return;
  }

  // Retrieve a point  
  TS_Point p = ctp.getPoint();

  p.x = map(p.x,0,240,240,0);

// 280-310 x, 10-40 y
  if (p.x > 0 && p.x < 50 && p.y > 270 && p.y < 320){
      homepage();
    }
    
//280-310 x, 75-105 y

  if (p.x > 65 && p.x < 115 && p.y > 270 && p.y < 320){
      settingsPage();
    }

}
